<html>
<head>
  <script src="../../assets/javascripts/jquery.js" type="text/javascript" ></script>
</head>
<body>
  <h1>Cyclops Publisher</h1>
  <h2>Publish a message:</h2>
  <form action="/publish?id=__ID__" method="POST">
    <p>
      <label for="id">Queue Id:</label><br />
      <input type="test" name="id" id="id"/>
    </p>
    <p>
      <label for="data">Data:</label><br />
      <textarea name="data" id="data" /></textarea>
    </p>
    <p>
      <input type="submit" name="post" id="post" />
    </p>
  </form>
  <script type="text/javascript">
  $(document).ready(function() {
    $('form').submit(function() {
      var action = this.action;
      //console.info(action);
      var id = $('#id').val();
      //console.info(id);
      action = action.replace(/__ID__/, id);
      //console.info(action);
      var data = $('#data').val();
      console.info('data='+data);
      console.info('posting...');
      jQuery.post(action, data, function(data, textStatus) {
        if(textStatus == 'success') {
          alert('success. data='+data);
        } else {
          alert(textStatus);
        }
      });
      return false;
    });
  });
  </script>
  </body>
</html>
